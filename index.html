<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RAF Ops â€” Aeropuerto (1940)</title>
  <style>
    :root{
      --bg:#0b0f14;--card:#111823;--muted:#8aa0b7;--text:#eaf2ff;--line:#1f2b3a;
      --good:#44d07e;--warn:#ffcc66;--warn2:#ff9f43;--bad:#ff5c7a;--accent:#7aa7ff;
      --gold:#ffcc66;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    body{margin:0;background:linear-gradient(180deg,#070a0f, #0b0f14);color:var(--text);}
    header{padding:16px 18px;border-bottom:1px solid var(--line);position:sticky;top:0;background:rgba(11,15,20,.9);backdrop-filter: blur(10px);z-index:5}
    h1{margin:0;font-size:16px;letter-spacing:.3px}
    .sub{color:var(--muted);font-size:12px;margin-top:4px}
    .wrap{max-width:1100px;margin:0 auto;padding:16px 18px 40px}
    .grid{display:grid;gap:12px}
    .row{display:grid;grid-template-columns:1.2fr .8fr;gap:12px}
    @media (max-width: 980px){.row{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px}
    .title{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .title h2{margin:0;font-size:13px;color:#d7e6ff;letter-spacing:.2px}
    .btns{display:flex;gap:8px;flex-wrap:wrap}

    button{
      background:#152236;border:1px solid #26364c;color:var(--text);
      padding:8px 10px;border-radius:10px;font-size:12px;cursor:pointer
    }
    button:hover{border-color:#345173}
    button.primary{background:linear-gradient(180deg,#1b2c47,#152236);border-color:#2d4a70}
    button.danger{background:linear-gradient(180deg,#3a1620,#241219);border-color:#7a2a3a}
    button:disabled{opacity:.45;cursor:not-allowed}

    .pill{
      display:inline-flex;gap:6px;align-items:center;border:1px solid var(--line);
      padding:4px 8px;border-radius:999px;color:var(--muted);font-size:11px
    }

    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 12px 0}
    .tabBtn{
      border-radius:999px;
      padding:7px 10px;
      border:1px solid #26364c;
      background:#0c131d;
      color:#d7e6ff;
      font-weight:700;
      font-size:12px;
      cursor:pointer;
    }
    .tabBtn.active{
      background:linear-gradient(180deg,#1b2c47,#152236);
      border-color:#2d4a70;
      color:#ffffff;
    }

    /* =========================
       LAYOUT: SQUADS + ROWS (PRO)
    ========================= */

    .slots{display:grid;grid-template-columns:1fr;gap:12px}

    .squadBlock{
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background:rgba(255,255,255,.02);
    }
    .squadHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      position:relative;
    }
    .squadHeader::before{
      content:"";
      position:absolute;left:0;top:0;bottom:0;width:8px;
      background: var(--sq-color, #2a3c55);
    }
    .squadTitle{font-weight:900;color:#eaf2ff;font-size:13px}
    .squadSub{color:var(--muted);font-size:11px;margin-top:4px}
    .squadRight{display:flex;gap:8px;align-items:center;flex-wrap:wrap}

    .squadList{
      display:grid;
      gap:10px;
      padding:12px;
    }

    .slot{
      position:relative;
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px;
      background:rgba(0,0,0,.10);
      overflow:hidden;
    }
    .slot::before{
      content:"";
      position:absolute;left:0;top:0;bottom:0;width:6px;
      background: var(--sq-color, #2a3c55);
    }

    /* âœ… 2 columnas: miniatura + contenido (acciones van dentro del contenido) */
    .slotRow{
      display:grid;
      grid-template-columns: 96px 1fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 560px){
      .slotRow{ grid-template-columns: 88px 1fr; }
    }

    .planeThumb{
      width:96px;
      height:72px;
      border-radius:14px;
      border:1px solid #26364c;
      background:#0c131d;
      object-fit:cover;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      flex:0 0 auto;
    }
    @media (max-width: 560px){
      .planeThumb{ width:88px; height:66px; }
    }

    .slotMain{min-width:0}

    .slotTopLine{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }

    .slotName{font-weight:900;font-size:14px}
    .slotMeta{
      color:var(--muted);
      font-size:11px;
      margin-top:3px;
      line-height:1.35;
    }

    .status{font-size:11px}
    .status.good{color:var(--good)} .status.warn{color:var(--warn)} .status.bad{color:var(--bad)} .status.warn2{color:var(--warn2)}

    .needsLine{
      margin-top:8px;
      color:#cfe2ff;
      font-size:11px;
      display:flex;
      gap:6px;
      flex-wrap:wrap
    }
    .needTag{
      display:inline-flex;align-items:center;gap:6px;
      padding:3px 7px;border-radius:999px;border:1px solid #26364c;background:#0c131d;
    }

    /* âœ… Acciones compactas, dentro del contenido (sin â€œcolumna raraâ€) */
    .slotActions{
      margin-top:10px;
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:flex-start;
      flex-wrap:wrap;
    }
    .slotActions button{
      padding:7px 10px;
      border-radius:12px;
      font-weight:800;
      white-space:nowrap;
    }
    .slotActions button:not(.primary):not(.danger){
      background:#0c131d;
      border-color:#26364c;
    }

    /* detalles plegables */
    details.slotDetails{
      margin-top:10px;
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background:rgba(255,255,255,.02);
    }
    details.slotDetails > summary{
      cursor:pointer;color:#d7e6ff;font-weight:900;font-size:12px;list-style:none;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
    }
    details.slotDetails > summary::-webkit-details-marker{display:none}
    .detailsBody{margin-top:10px;display:grid;gap:10px}

    .hr{height:1px;background:var(--line);margin:10px 0}

    .kv{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width: 560px){ .kv{grid-template-columns:1fr} }

    .k{color:var(--muted);font-size:11px}
    .v{font-size:12px}
    .muted{color:var(--muted)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}

    .state.good{color:var(--good)}
    .state.warn{color:var(--warn)}
    .state.warn2{color:var(--warn2)}
    .state.bad{color:var(--bad)}

    .stars{color:var(--gold); font-weight:900; letter-spacing:.5px;}

    .bar{
      height:10px;background:#0c131d;border:1px solid #213044;border-radius:999px;overflow:hidden
    }
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#63ffd1);width:0%}
    .miniBarWrap{margin-top:10px}
    .miniBarRow{display:flex;justify-content:space-between;gap:10px;align-items:center;margin-bottom:6px}
    .miniBarRow .muted{font-size:11px}

    .mission{
      border:1px solid var(--line);border-radius:14px;padding:12px;
      background:rgba(255,255,255,.02)
    }
    .missionHead{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
    .mName{font-weight:700;font-size:13px}
    .mSmall{color:var(--muted);font-size:11px;margin-top:2px}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}

    .rightCol .card{height:100%}
    .log{max-height:260px;overflow:auto;border:1px dashed #2a3c55;border-radius:12px;padding:10px;background:rgba(0,0,0,.12)}
    .log p{margin:0 0 8px 0;color:#cfe2ff;font-size:12px}

    select{
      width:100%;
      background:#0c131d;border:1px solid #26364c;color:var(--text);
      border-radius:10px;padding:6px 8px;font-size:12px;outline:none;
    }

    .sqBadge{
      display:inline-flex;align-items:center;gap:6px;
      border-radius:999px;padding:4px 8px;font-size:11px;border:1px solid var(--line)
    }

    details{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background:rgba(255,255,255,.02);
    }
    details > summary{
      cursor:pointer;color:#d7e6ff;font-weight:700;font-size:12px;list-style:none;
    }
    details > summary::-webkit-details-marker{display:none}

    .pilots{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    @media (max-width: 760px){.pilots{grid-template-columns:1fr}}

    .pilot{
      border:1px solid var(--line);border-radius:14px;padding:12px;background:rgba(255,255,255,.02)
    }
    .pilotTop{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
    .pilotName{font-weight:800;font-size:13px}
    .pilotMeta{color:var(--muted);font-size:11px;margin-top:2px;line-height:1.35}
    .tagDead{border:1px solid #7a2a3a;background:#241219;color:#ffd7df}
    .tagRest{border:1px solid #2d4a70;background:#152236;color:#d7e6ff}

    .modalMask{
      position:fixed;inset:0;background:rgba(0,0,0,.55);
      display:none;align-items:center;justify-content:center;z-index:50;padding:18px;
    }
    .modal{
      width:min(560px, 100%);
      background:linear-gradient(180deg,#0e1520,#0b1018);
      border:1px solid #26364c;border-radius:16px;padding:14px;
      box-shadow:0 20px 60px rgba(0,0,0,.55);
    }
    .modalTop{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
    .modal h3{margin:0;font-size:14px}
    .modal .muted{font-size:12px}
    .modalGrid{display:grid;gap:10px;margin-top:12px}
    .choice{
      border:1px solid #26364c;border-radius:14px;padding:12px;background:rgba(255,255,255,.03);
      display:flex;justify-content:space-between;align-items:center;gap:12px;
    }
    .choice:hover{border-color:#345173}
    .sqChoice{cursor:pointer}
    .sqDot{width:10px;height:10px;border-radius:999px;box-shadow:0 0 0 3px rgba(255,255,255,.04);}
    .smallBtnRow{display:flex;gap:8px;flex-wrap:wrap}

    .tabPanel{display:none}
    .tabPanel.active{display:block}
  </style>
</head>
<body>
<header>
  <div class="wrap" style="padding:0 18px;">
    <h1>RAF Ops â€” Aeropuerto en alerta (1940)</h1>
    <div class="sub">v1.0: personal de tierra + lÃ­mites simultÃ¡neos + colas + contrataciÃ³n (modular).</div>
  </div>
</header>

<div class="wrap grid">
  <div class="row">
    <div class="card">
      <div class="title">
        <h2>ğŸ›©ï¸ Aeropuerto</h2>
        <div class="btns">
          <span class="pill">Puntos: <b id="points">0</b></span>
          <button class="primary" id="btnNewMission">Generar misiÃ³n</button>
          <span class="pill muted">Coste: <b id="missionCostLabel">2</b> pts</span>
          <button class="primary" id="btnShop">Reclutar / Comprar</button>
          <button id="btnSave">Guardar</button>
          <button class="danger" id="btnReset">Reset</button>
        </div>
      </div>

      <div class="tabs">
        <button class="tabBtn active" data-tab="PLANES">ğŸ›©ï¸ Aviones</button>
        <button class="tabBtn" data-tab="PILOTS">ğŸ‘¨â€âœˆï¸ Pilotos</button>

        <span class="pill">Aviones: <b id="planeCount">0</b></span>
        <span class="pill">Pilotos vivos: <b id="pilotAliveCount">0</b></span>

        <span class="pill">ğŸ‘· Fuelers: <b id="fuelersLabel">0</b></span>
        <span class="pill">ğŸ§° MecÃ¡nicos: <b id="mechanicsLabel">0</b></span>
        <span class="pill">ğŸ”« Armeros: <b id="armorersLabel">0</b></span>

        <span class="pill">â›½ Cola: <b id="qFuel">0</b></span>
        <span class="pill">ğŸ› ï¸ Cola: <b id="qMaint">0</b></span>
        <span class="pill">ğŸ”« Cola: <b id="qAmmo">0</b></span>
      </div>

      <div id="tabPlanes" class="tabPanel active">
        <div class="slots" id="slots"></div>
      </div>

      <div id="tabPilots" class="tabPanel">
        <div class="pilots" id="pilots"></div>
      </div>
    </div>
      <div class="card">
        <div class="title">
          <h2>ğŸ—ºï¸ CampaÃ±a</h2>
          <span class="pill">Turno: <b id="campTurn">0</b></span>
        </div>

        <div class="muted" style="font-size:11px;margin-bottom:10px">
          Localidades activas y rutas (vista previa). AÃºn no afecta a las misiones.
        </div>

        <div class="grid" id="campList"></div>
      </div>

    <div class="rightCol grid">
      <div class="card">
        <div class="title">
          <h2>ğŸ“Œ Misiones activas</h2>
          <span class="pill">Activas: <b id="activeCount">0</b></span>
        </div>
        <div class="grid" id="missionsActive"></div>

        <div style="margin-top:12px" class="grid">
          <details id="pendingDetails" open>
            <summary>Misiones pendientes (<span id="pendingCount">0</span>)</summary>
            <div class="detailsBody" id="missionsPending"></div>
          </details>

          <details id="historyDetails">
            <summary>Historial (<span id="historyCount">0</span>)</summary>
            <div class="detailsBody" id="missionsHistory"></div>
          </details>
        </div>
      </div>

      <div class="card">
        <div class="title">
          <h2>ğŸ“œ Registro</h2>
          <span class="pill mono" id="clock">--:--:--</span>
        </div>
        <div class="log" id="log"></div>
        <div class="muted" style="margin-top:10px;font-size:11px">
          Nota: el personal limita cuÃ¡ntos servicios simultÃ¡neos se pueden hacer. Si no hay personal libre, el trabajo entra en cola.
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modalMask" id="modalMask" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modalTop">
      <div>
        <h3 id="modalTitle">â€”</h3>
        <div class="muted" id="modalSubtitle">â€”</div>
      </div>
      <button id="modalClose">Cerrar</button>
    </div>
    <div class="modalGrid" id="modalBody"></div>
  </div>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>

